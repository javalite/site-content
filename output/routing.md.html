<p>Request routing| <a href="/activeweb">ActiveWeb</a>,Request routing</p>
<div id="toc"></div>

<h1 id="request-routing">Request routing</h1>
<p>Routing in ActiveWeb is an act of matching an incoming request URL to a controller and action. Current implementation supports built-in standard routing, built-in REST - based routing as well as custom routing.</p>
<h2 id="standard-routing">Standard routing</h2>
<p>NOTE: the &quot;context&quot; in all URIs is a web application context, which is usually a WAR file name.</p>
<table>
<col width="32%" />
<col width="42%" />
<col width="15%" />
<col width="8%" />
<thead>
<tr class="header">
<th align="left">path</th>
<th align="left">controller</th>
<th align="left">action</th>
<th align="left">id</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">/books</td>
<td align="left">app.controllers.BooksController</td>
<td align="left">index</td>
<td align="left">
</td>
</tr>
<tr class="even">
<td align="left">/books/save</td>
<td align="left">app.controllers.BooksController</td>
<td align="left">save</td>
<td align="left">
</td>
</tr>
<tr class="odd">
<td align="left">/books/save/123</td>
<td align="left">app.controllers.BooksController</td>
<td align="left">save</td>
<td align="left">123</td>
</tr>
</tbody>
</table>
<p>In standard routing, the HTTP method is not considered, but you might get an exception of you send an HTTP method to an action that is configured for a different HTTP method. Routing and action HTTP methods are independent in case of standard routing. For standard routing, there is no need to do anything, it works by default</p>
<h2 id="restful-routing">RESTful routing</h2>
<p>In case of restful routing, the actions are pre-configured. RESTful routing is configured by placing a @RESTfull annotation on a controller. For more informaiton, see: <a href="controllers#restful-controllers">RESTful controllers</a></p>
<table>
<col width="13%" />
<col width="16%" />
<col width="25%" />
<col width="9%" />
<col width="34%" />
<thead>
<tr class="header">
<th align="left">HTTP method</th>
<th align="left">path</th>
<th align="left">controller</th>
<th align="left">action</th>
<th align="left">used for</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">GET</td>
<td align="left">/books</td>
<td align="left">app.controllers.BooksController</td>
<td align="left">index</td>
<td align="left">display a list of all books</td>
</tr>
<tr class="even">
<td align="left">GET</td>
<td align="left">/books/new_form</td>
<td align="left">app.controllers.BooksController</td>
<td align="left">new_form</td>
<td align="left">return an HTML form for creating a new book</td>
</tr>
<tr class="odd">
<td align="left">POST</td>
<td align="left">/books</td>
<td align="left">app.controllers.BooksController</td>
<td align="left">create</td>
<td align="left">create a new book</td>
</tr>
<tr class="even">
<td align="left">GET</td>
<td align="left">/books/id</td>
<td align="left">app.controllers.BooksController</td>
<td align="left">show</td>
<td align="left">display a specific book</td>
</tr>
<tr class="odd">
<td align="left">GET</td>
<td align="left">/books/id/edit_form</td>
<td align="left">app.controllers.BooksController</td>
<td align="left">edit_form</td>
<td align="left">return an HTML form for editing a books</td>
</tr>
<tr class="even">
<td align="left">PUT</td>
<td align="left">/books/id</td>
<td align="left">app.controllers.BooksController</td>
<td align="left">update</td>
<td align="left">update a specific book</td>
</tr>
<tr class="odd">
<td align="left">DELETE</td>
<td align="left">/books/id</td>
<td align="left">app.controllers.BooksController</td>
<td align="left">destroy</td>
<td align="left">delete a specific book</td>
</tr>
</tbody>
</table>
<h2 id="routing-with-packages">Routing with packages</h2>
<p>While <code>app.controllers</code> is a default package for controllers, you might want to organize them into sub-packages. These sub-packages can only be children of <code>app.controllers</code> package though. In case a controller is located in a sub-packages, the path mapping would also include sub-package names:</p>
<p>Standard routing</p>
<table>
<col width="37%" />
<col width="43%" />
<col width="9%" />
<col width="9%" />
<thead>
<tr class="header">
<th align="left">path</th>
<th align="left">controller</th>
<th align="left">action</th>
<th align="left">id</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">/package1/books</td>
<td align="left">app.controllers.package1.BooksController</td>
<td align="left">index</td>
<td align="left">
</td>
</tr>
<tr class="even">
<td align="left">/package1/books/save</td>
<td align="left">app.controllers.package1.BooksController</td>
<td align="left">save</td>
<td align="left">
</td>
</tr>
<tr class="odd">
<td align="left">/package1/books/save/123</td>
<td align="left">app.controllers.package1.BooksController</td>
<td align="left">save</td>
<td align="left">123</td>
</tr>
<tr class="even">
<td align="left">/package1/package2/books</td>
<td align="left">app.controllers.package1.package2.BooksController</td>
<td align="left">index</td>
<td align="left">
</td>
</tr>
<tr class="odd">
<td align="left">/package1/package2/books/save</td>
<td align="left">app.controllers.package1.package2.BooksController</td>
<td align="left">save</td>
<td align="left">
</td>
</tr>
<tr class="even">
<td align="left">/package1/package2/books/save/123</td>
<td align="left">app.controllers.package1.package2.BooksController</td>
<td align="left">save</td>
<td align="left">123</td>
</tr>
</tbody>
</table>
<p>RESTful routing supports sub-packaging exactly the same as standard.</p>
<h2 id="mapping-paths-to-controller-names">Mapping paths to controller names</h2>
<p>When matching a path to a controller class, ActiveWeb converts a name of a controller from underscore or hyphenated format to CamelCase:</p>
<table>
<thead>
<tr class="header">
<th align="left">path</th>
<th align="center">controller</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">/books</td>
<td align="center">app.controllers.package1.BooksController</td>
</tr>
<tr class="even">
<td align="left">/student_books</td>
<td align="center">app.controllers.package1.StudentBooksController</td>
</tr>
<tr class="odd">
<td align="left">/student-books</td>
<td align="center">app.controllers.package1.StudentBooksController</td>
</tr>
</tbody>
</table>
<h2 id="custom-routing">Custom routing</h2>
<p>Besides standard and RESTful, ActiveWeb also offers custom routing. Custom routing provides ability to configure custom URIs to be forwarded to specific controllers and actions.</p>
<h3 id="custom-routing-configuration">Custom routing configuration</h3>
<p>As with any other types of configuration, ActiveWeb route configuration is done in code, rather that property or XML files. Custom routing is done by adding a new class to the application: <code>app.config.RouteConfig</code>:</p>
<pre class="sourceCode java"><code class="sourceCode java"><span class="kw">public</span> <span class="kw">class</span> RouteConfig <span class="kw">extends</span> AbstractRouteConfig {
    <span class="kw">public</span> <span class="dt">void</span> <span class="fu">init</span>(AppContext appContext) {
        <span class="fu">route</span>(<span class="st">&quot;/myposts&quot;</span>).<span class="fu">to</span>(PostsController.<span class="fu">class</span>);
        <span class="fu">route</span>(<span class="st">&quot;/{action}/{controller}/{id}&quot;</span>);
        <span class="fu">route</span>(<span class="st">&quot;/{action}/greeting/{name}&quot;</span>).<span class="fu">to</span>(HelloController.<span class="fu">class</span>);
    }
}</code></pre>
<p>Custom routing is based on URI segments, which are chunks of URIs submitted of the request separated by slashes. For example the following URI has three segments:</p>
<pre class="prettyprint"><code>/greeting/show/bob</code></pre>
<p>The above URI has three segments: &quot;greeting&quot;, &quot;show&quot;, &quot;bob&quot;.</p>
<p>ActiveWeb defines three types of segments:</p>
<ul>
<li>Built in</li>
<li>Static</li>
<li>User (or dynamic)</li>
</ul>
<h3 id="built-in-segments">Built-in segments</h3>
<p>ActiveWeb defines three built-in segments:</p>
<ul>
<li><code>{controller}</code></li>
<li><code>{action}</code></li>
<li><code>{id}</code></li>
</ul>
<p>Using built-in segments, you can reorder where controller, action and Id appear on the URI:</p>
<pre class="prettyprint"><code>/(action)/{controller}/{id}</code></pre>
<p>When such a route is specified, this URI:</p>
<pre class="prettyprint"><code>/show/photo/123</code></pre>
<p>Will be routed to: <code>app.controllers.PhotoController#show</code> with ID ==123.</p>
<h3 id="static-segments">Static segments</h3>
<p>Static segments are simply plain text without the braces. The are matched one to one with the incoming request. Example:</p>
<pre class="sourceCode java"><code class="sourceCode java"><span class="fu">route</span>(<span class="st">&quot;/{action}/greeting/{name}&quot;</span>).<span class="fu">to</span>(HelloController.<span class="fu">class</span>);</code></pre>
<p>In the snippet above, &quot;greeting&quot; is a static segment.</p>
<h3 id="userdynamic-segments">User/dynamic segments</h3>
<p>User segments are any text in braces in configuration which are then converted to parameters that can be retrieved inside controllers and filters. Here is an example:</p>
<pre class="sourceCode java"><code class="sourceCode java"><span class="fu">route</span>(<span class="st">&quot;/{action}/greeting/{name}&quot;</span>).<span class="fu">to</span>(HelloController.<span class="fu">class</span>);</code></pre>
<p>where &quot;name&quot; is a placeholder whose value will be available in controller:</p>
<p>URL submitted:</p>
<pre class="prettyprint"><code>/show/greeting/alex</code></pre>
<p>will be routed to controller <code>app.controllers.HelloController#show</code> and value <code>name</code> will be available:</p>
<pre class="sourceCode java"><code class="sourceCode java"><span class="kw">public</span> <span class="kw">class</span> HelloController <span class="kw">extends</span> AppController{
  <span class="kw">public</span> <span class="dt">void</span> <span class="fu">show</span>(){
    String name = <span class="fu">param</span>(<span class="st">&quot;name&quot;</span>);
  }
}</code></pre>
<h3 id="wild-card-routing">Wild card routing</h3>
<p>Sometimes you need to route a really long URI to a controller. Here is how:</p>
<pre class="sourceCode java"><code class="sourceCode java"><span class="fu">route</span>(<span class="st">&quot;/blog/*items&quot;</span>).<span class="fu">to</span>(PostsController.<span class="fu">class</span>).<span class="fu">action</span>(<span class="st">&quot;index&quot;</span>);</code></pre>
<p>In a case the following URL is submitted:</p>
<pre class="prettyprint"><code>/blog/2014/07/23/how-to-define-activeweb-routes</code></pre>
<p>it will be routed to controller <code>app.controllers.PostsController#index</code> and value <code>items</code> will be available:</p>
<pre class="sourceCode java"><code class="sourceCode java"><span class="kw">public</span> <span class="kw">class</span> PostsController <span class="kw">extends</span> AppController{
  <span class="kw">public</span> <span class="dt">void</span> <span class="fu">index</span>(){
    <span class="fu">logInfo</span>(<span class="fu">param</span>(<span class="st">&quot;items&quot;</span>)); <span class="co">// will print: 2014/07/23/how-to-define-activeweb-routes</span>
  }
}</code></pre>
<h3 id="http-method---based-routing">Http method - based routing</h3>
<p>You can include an Http method used in the request into the routing rule:</p>
<pre class="sourceCode java"><code class="sourceCode java"><span class="fu">route</span>(<span class="st">&quot;/{action}/greeting/{name}&quot;</span>).<span class="fu">to</span>(HelloController.<span class="fu">class</span>).<span class="fu">get</span>();</code></pre>
<p>In this example, this route will only match the incoming request if the Http method of the request is GET. There are four corresponding methods: <code>get()</code>, <code>post()</code>, <code>put()</code> and <code>delete()</code>. They can be used in isolation or in combination. For instance, this route:</p>
<pre class="sourceCode java"><code class="sourceCode java"><span class="fu">route</span>(<span class="st">&quot;/{action}/greeting&quot;</span>).<span class="fu">to</span>(HelloController.<span class="fu">class</span>).<span class="fu">get</span>().<span class="fu">post</span>();</code></pre>
<p>will match these requests:</p>
<p>GET:</p>
<pre class="prettyprint"><code>/show/greeting</code></pre>
<p>POST:</p>
<pre class="prettyprint"><code>/save/greeting</code></pre>
<p>Of course the action <code>save()</code> needs to have a @POST annotation for this to work. Annotations are independent of routing rules.</p>
<blockquote>
<p>Default Http method used in routing rules is <code>get()</code>.</p>
</blockquote>
<h3 id="routeconfig-reloaded">RouteConfig reloaded</h3>
<p>The class <code>app.config.RouteConfig</code> is recompiled and reloaded in development environment in case a system property <code>active_reload</code> is set to true. This makes it easy and fun to play with the routes during development. Please see <a href="running_in_development_mode">Running in development mode</a> for more information.</p>
