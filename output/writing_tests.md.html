<ol class=breadcrumb>
   <li>
<a href=/>Home</a>
</li>
   <li>
<a href=/activejdbc>ActiveJDBC</a>
</li>
   <li class=active>
Writing tests
</li>
</ol>
<div class=page-header>
   <h1>
Writing tests <small></small>
</h1>
</div>
<p>ActiveJDBC - Writing tests| <a href="/activejdbc">ActiveJDBC</a>, Writing tests</p>
<p>While you can use any Java technology to do this, JavaLite provides a combination of <a href="http://junit.org/">JUnit</a> and <a href="jspec">JSpec</a>. Test methods are written in a style where a name of a method is a phrase reflecting the expectation of the author and usually start with a word &quot;should&quot;.</p>
<h2 id="specification-jargon">Specification jargon</h2>
<p>Usually in the Java world, people call tests ... tests. The author and friends have been calling them specifications or specs for short. This name fits better if you practice TDD, as in &quot;specifications of behavior&quot; rather than code testing after development. While the change is in the name, it might be enough to have a slight shift in mentality towards TDD.</p>
<h2 id="example-process-of-writing-a-specification">Example process of writing a specification</h2>
<p>Lets write a simple model:</p>
<pre class="sourceCode java"><code class="sourceCode java"><span class="kw">public</span> <span class="kw">class</span> Person <span class="kw">extends</span> Model{}</code></pre>
<p>Usually, at this point it is time to write a test:</p>
<pre class="sourceCode java"><code class="sourceCode java"><span class="kw">public</span> <span class="kw">class</span> PersonSpec{
  @Test
  <span class="kw">public</span> <span class="dt">void</span> <span class="fu">shouldValidatePresenceOfFirstNameAndLastName</span>(){
     Person p = <span class="kw">new</span> <span class="fu">Person</span>();
     <span class="fu">a</span>(p).<span class="fu">shouldNotBe</span>(<span class="st">&quot;valid&quot;</span>);
  }
}</code></pre>
<p>When the code above runs, the spec is in red because the class Person does not specify any validations yet, and therefore it is valid. This test will fail on line 5. However, our goal for this model is not be valid if it is missing first and last name attributes. In order to make it pass, you need to add validations to the model:</p>
<pre class="sourceCode java"><code class="sourceCode java"><span class="kw">public</span> <span class="kw">class</span> Person <span class="kw">extends</span> Model{
   <span class="fu">validatePresenceOf</span>(<span class="st">&quot;first_name&quot;</span>, <span class="st">&quot;last_name&quot;</span>);
}</code></pre>
<p>When you re-run test, it will pass.</p>
<p>At this point, we need to add values for first and last name, as well as an expectation of a valid state of the model:</p>
<pre class="sourceCode java"><code class="sourceCode java"><span class="kw">public</span> <span class="kw">class</span> PersonSpec{
  @Test
  <span class="kw">public</span> <span class="dt">void</span> <span class="fu">shouldValidatePresenceOfFirstNameAndLastName</span>(){
     Person p = <span class="kw">new</span> <span class="fu">Person</span>();
     <span class="fu">a</span>(p).<span class="fu">shouldNotBe</span>(<span class="st">&quot;valid&quot;</span>);
     p.<span class="fu">set</span>(<span class="st">&quot;first_name&quot;</span>, <span class="st">&quot;Homer&quot;</span>);
     p.<span class="fu">set</span>(<span class="st">&quot;last_name&quot;</span>, <span class="st">&quot;Simpson&quot;</span>);
     <span class="fu">a</span>(p).<span class="fu">shouldBe</span>(<span class="st">&quot;valid&quot;</span>);
   }
}</code></pre>
<p>At line 5, the test passes as before because the model still does not have the first and last names, but on lines 6 and 7, we add these, and on line 8 we expect the model to finally be valid.</p>
<p>We now have a complete specification of behavior and at the same time we built an implementation. It is typical to switch from spec to a model and back a few times until all behavior is documented in the spec and implementation is complete to satisfy it.</p>
<h2 id="example-of-writing-a-test">Example of writing a test</h2>
<p>In a real scenario, you would also need to open a database connection before the test and close it after the test. This provides an example of a real working test from one of the example projects:</p>
<pre class="sourceCode java"><code class="sourceCode java">@Test
<span class="kw">public</span> <span class="dt">void</span> <span class="fu">shouldValidateMandatoryFields</span>(){
    Employee employee = <span class="kw">new</span> <span class="fu">Employee</span>();
    <span class="co">//check errors</span>
    <span class="fu">the</span>(employee).<span class="fu">shouldNotBe</span>(<span class="st">&quot;valid&quot;</span>);
    <span class="fu">the</span>(employee.<span class="fu">errors</span>().<span class="fu">get</span>(<span class="st">&quot;first_name&quot;</span>)).<span class="fu">shouldBeEqual</span>(<span class="st">&quot;value is missing&quot;</span>);
    <span class="fu">the</span>(employee.<span class="fu">errors</span>().<span class="fu">get</span>(<span class="st">&quot;last_name&quot;</span>)).<span class="fu">shouldBeEqual</span>(<span class="st">&quot;value is missing&quot;</span>);
    <span class="co">//set missing values</span>
    employee.<span class="fu">set</span>(<span class="st">&quot;first_name&quot;</span>, <span class="st">&quot;John&quot;</span>, <span class="st">&quot;last_name&quot;</span>, <span class="st">&quot;Doe&quot;</span>);
    <span class="co">//all is good:</span>
    <span class="fu">the</span>(employee).<span class="fu">shouldBe</span>(<span class="st">&quot;valid&quot;</span>);
}</code></pre>
<p>For a complete code please refer to: <a href="https://github.com/javalite/simple-example/blob/master/src/test/java/activejdbc/examples/simple/EmployeeSpec.java">EmployeeSpec.java</a> and enclosing project.</p>
